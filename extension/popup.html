
<!DOCTYPE html>
<html>
<head>
  <title>Mojify</title>
  <link rel="stylesheet" type="text/css" href="popup.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <div class="app-container">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">
          <img src="icons/icon48.png" alt="Mojify" class="logo-png">
        </div>
        <div class="logo-text">
          <h1>Mojify</h1>
          <span class="version">v1.0</span>
        </div>
      </div>
    </div>

    <div class="tab-container">
      <div class="tab-header">
        <button class="tab-btn active" data-tab="emotes">
          <i class="fas fa-grin"></i>
          <span>Emotes</span>
        </button>
        <button class="tab-btn" data-tab="settings">
          <i class="fas fa-cog"></i>
          <span>Settings</span>
        </button>
        <div class="tab-indicator"></div>
      </div>

      <div class="tab-content">
        <!-- Emotes Tab -->
        <div class="tab-pane active" id="emotes-tab">
          <div class="search-container">
            <div class="search-input-wrapper">
              <i class="fas fa-search"></i>
              <input type="text" id="search-emotes" placeholder="Search emotes">
            </div>
          </div>

          <div class="emote-stats">
            <div class="stat">
              <span class="stat-number" id="emote-count">0</span>
              <span class="stat-label">Emotes</span>
            </div>
            <button id="download-button" class="action-button">
              <i class="fas fa-sync-alt"></i>
              <span>Refresh Emotes</span>
            </button>
          </div>

          <div class="download-progress hidden" id="download-progress">
            <div class="progress-info">
              <span id="progress-text">Downloading emotes...</span>
              <span id="progress-count">0/0</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progress-fill"></div>
            </div>
          </div>

          <div class="emotes-container">
            <div class="no-emotes-message" id="no-emotes-message">
              <i class="fas fa-ghost empty-icon"></i>
              <p>No emotes loaded</p>
              <p class="empty-subtitle">Add channel IDs in Settings tab and click Refresh Emotes</p>
            </div>

            <div class="emote-grid" id="emote-grid"></div>

            <div class="load-more hidden" id="load-more">
              <button id="load-more-btn">Load More</button>
            </div>
          </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-pane" id="settings-tab">
          <div class="settings-section">
            <h2 class="section-title">Channel Configuration</h2>
            <p class="section-description">Enter Twitch channel IDs to load their 7TV emotes</p>

            <div class="form-group">
              <label for="channel-ids">Twitch Channel IDs</label>
              <textarea id="channel-ids" placeholder="Enter channel IDs, one per line or comma-separated"></textarea>
              <div class="helper-text">Example: xqc, forsen, sodapoppin</div>
            </div>

            <div class="info-box" style="background: #e3f2fd; border: 1px solid #2196f3; border-radius: 8px; padding: 12px; margin: 16px 0; font-size: 14px;">
              <div style="display: flex; align-items: center; margin-bottom: 8px;">
                <i class="fas fa-info-circle" style="color: #2196f3; margin-right: 8px;"></i>
                <strong>Automatic Downloads</strong>
              </div>
              <p style="margin: 0; color: #666;">Emotes will automatically download when you save channel IDs. Progress will be shown and emotes will be ready to use immediately after download completes.</p>
            </div>

            <button id="save-button" class="primary-button">
              <i class="fas fa-save"></i>
              <span>Save Channel IDs</span>
            </button>
          </div>

          <div class="settings-section channel-management" id="channel-management" style="display: none;">
            <h2 class="section-title">Channel Management</h2>
            <div class="channel-list" id="channel-list">
              <!-- Channels will be populated here -->
            </div>
          </div>

          <div class="settings-section backup-restore">
            <h2 class="section-title">Backup & Restore</h2>
            <p class="section-description">Backup and restore all your emotes, settings, and configurations</p>

            <div class="backup-restore-actions">
              <button id="create-backup" class="primary-button">
                <i class="fas fa-download"></i>
                <span>Create Backup</span>
              </button>

              <div class="restore-section">
                <input type="file" id="restore-file" accept=".json" style="display: none;">
                <button id="restore-backup" class="secondary-button">
                  <i class="fas fa-upload"></i>
                  <span>Restore Backup</span>
                </button>
              </div>
            </div>

            <div class="backup-info">
              <div class="info-item">
                <i class="fas fa-check-circle"></i>
                <span>Emote collection with images</span>
              </div>
              <div class="info-item">
                <i class="fas fa-check-circle"></i>
                <span>Channel configurations</span>
              </div>
              <div class="info-item">
                <i class="fas fa-check-circle"></i>
                <span>Emote mappings</span>
              </div>
              <div class="info-item">
                <i class="fas fa-check-circle"></i>
                <span>Minibar positions for all sites</span>
              </div>
            </div>

            <div class="backup-progress hidden" id="backup-progress">
              <div class="progress-info">
                <span id="backup-progress-text">Creating backup...</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="backup-progress-fill"></div>
              </div>
            </div>
          </div>

          <div class="settings-section storage-info">
            <h2 class="section-title">Storage Information</h2>
            <div class="storage-details">
              <div class="storage-item">
                <span class="storage-label">Total Emotes:</span>
                <span class="storage-value" id="total-emotes-count">0</span>
              </div>
              <div class="storage-item">
                <span class="storage-label">Storage Used:</span>
                <span class="storage-value" id="storage-used">0 KB</span>
              </div>
              <div class="storage-item">
                <span class="storage-label">Channels:</span>
                <span class="storage-value" id="channels-count">0</span>
              </div>
            </div>
            <button id="clear-all-storage" class="danger-button">
              <i class="fas fa-trash"></i>
              <span>Clear All Data</span>
            </button>
          </div>

          <div class="settings-section usage-section">
            <h2 class="section-title">Usage Instructions</h2>
            <div class="usage-item">
              <i class="fas fa-keyboard"></i>
              <div>
                <h3>Type Emote Code</h3>
                <p>Type an emote code surrounded by colons (e.g., <code>:kappa:</code>) anywhere on the web to automatically replace it with the emote.</p>
              </div>
            </div>

            <div class="usage-item">
              <i class="fas fa-mouse-pointer"></i>
              <div>
                <h3>Click to Insert</h3>
                <p>Click on any emote in the extension popup to instantly insert it into text fields on supported websites.</p>
              </div>
            </div>

            <div class="usage-item">
              <i class="fas fa-search"></i>
              <div>
                <h3>Search Emotes</h3>
                <p>Use the search bar in the Emotes tab to quickly find specific emotes by name.</p>
              </div>
            </div>

            <div class="usage-item">
              <i class="fas fa-download"></i>
              <div>
                <h3>Add New Emotes</h3>
                <p>Add Twitch channel IDs in the Channel Configuration section and click "Save Channel IDs" to download their emotes.</p>
              </div>
            </div>

            <div class="usage-item">
              <i class="fas fa-cloud-download-alt"></i>
              <div>
                <h3>Backup & Restore</h3>
                <p>Create backups of your emote collection regularly and restore them when needed using the Backup & Restore section.</p>
              </div>
            </div>
          </div>

          <div class="settings-section about-section">
            <h2 class="section-title">About Mojify</h2>
            <p class="about-text">Mojify lets you use Twitch emotes anywhere on the web by typing their name surrounded by colons.</p>
            <p class="about-text">Example: typing <code>:pepelaugh:</code> will insert the PepeLaugh emote.</p>
            <p class="about-text"><b>New!</b> Click any emote to instantly insert it in messenger.com</p>
            <p class="powered-by">Powered by 7TV</p>
          </div>

          <div class="settings-section debug-section">
            <h2 class="section-title">
              Debug Tools
              <button id="toggle-debug" class="toggle-button">Show</button>
            </h2>

            <div id="debug-content" class="debug-content" style="display: none;">
              <div class="debug-info">
                <p>These tools help diagnose problems with text field detection.</p>
              </div>

              <div class="debug-actions">
                <button id="debug-find-field" class="debug-button">
                  <i class="fas fa-search"></i> Find Text Field
                </button>

                <button id="debug-insert-text" class="debug-button">
                  <i class="fas fa-font"></i> Insert Test Text
                </button>

                <button id="debug-detect-page" class="debug-button">
                  <i class="fas fa-code"></i> Analyze Page
                </button>

                <button id="debug-test-dragdrop" class="debug-button">
                  <i class="fas fa-images"></i> Test Drag & Drop
                </button>

                <button id="debug-test-basic" class="debug-button">
                  <i class="fas fa-vial"></i> Test Basic Functionality
                </button>
              </div>

              <div id="debug-result" class="debug-result">
                <div class="debug-result-header">Results will appear here</div>
                <div class="debug-result-content"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="notification" class="notification hidden"></div>

    <!-- Custom Modal Confirmation Dialog -->
    <div id="confirmation-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3 id="modal-title">Confirm Action</h3>
        </div>
        <div class="modal-body">
          <p id="modal-message">Are you sure you want to proceed?</p>
        </div>
        <div class="modal-footer">
          <button id="modal-cancel" class="secondary-button">
            <span>Cancel</span>
          </button>
          <button id="modal-confirm" class="danger-button">
            <span>Confirm</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
